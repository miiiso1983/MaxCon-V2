# تعليمات اختبار استيراد وتصدير Excel للموردين

## المشاكل التي تم إصلاحها:

### 🔧 **مشكلة التصدير:**
- ✅ **إضافة debug logging** - لتتبع عدد الموردين
- ✅ **إصلاح accessor methods** - إضافة دوال getTypeLabel و getStatusLabel
- ✅ **إنشاء موردين تجريبيين** - لاختبار التصدير

### 🔧 **مشكلة الاستيراد:**
- ✅ **إصلاح validation rules** - دعم أسماء الأعمدة المختلفة
- ✅ **تحسين دالة model** - معالجة أفضل للبيانات
- ✅ **إضافة فحص التكرار** - تجنب إنشاء موردين مكررين
- ✅ **إضافة debug logging** - لتتبع عملية الاستيراد

## خطوات الاختبار:

### 📤 **اختبار التصدير:**
1. اذهب إلى صفحة الموردين: `/tenant/purchasing/suppliers`
2. اضغط على زر "تصدير Excel"
3. يجب أن يتم تحميل ملف Excel يحتوي على:
   - العناوين العربية
   - 3 موردين تجريبيين على الأقل
   - تنسيق جميل مع ألوان

### 📥 **اختبار الاستيراد:**
1. اضغط على زر "تحميل قالب Excel"
2. احفظ الملف وأضف موردين جدد
3. ارفع الملف باستخدام زر "استيراد Excel"
4. يجب أن تظهر رسالة نجاح مع عدد الموردين المستوردين

### 📋 **قالب الاستيراد:**
الأعمدة المطلوبة:
- **اسم المورد*** (مطلوب)
- **رمز المورد** (اختياري - سيتم توليده تلقائياً)
- **نوع المورد** (distributor, manufacturer, wholesaler, retailer, service_provider)
- **الحالة** (active, inactive, suspended)
- **شخص الاتصال**
- **الهاتف**
- **البريد الالكتروني**
- **العنوان**
- **الرقم الضريبي**
- **شروط الدفع** (cash, credit_7, credit_15, credit_30, credit_45, credit_60, credit_90, custom)
- **حد الائتمان**
- **العملة** (IQD, USD, EUR)
- **الفئة** (pharmaceutical, medical_equipment, cosmetics, supplements, other)
- **ملاحظات**

### 🔍 **فحص السجلات (في حالة المشاكل):**
```bash
# فحص سجلات Laravel
tail -f storage/logs/laravel.log

# البحث عن رسائل التصدير
grep "SuppliersExport" storage/logs/laravel.log

# البحث عن رسائل الاستيراد
grep "SuppliersImport" storage/logs/laravel.log
```

### 📊 **الموردين التجريبيين المنشأين:**
1. **شركة الأدوية المتحدة** (SUP-001)
2. **شركة المعدات الطبية** (SUP-002)
3. **شركة مستحضرات التجميل** (SUP-003)

### 🎯 **النتائج المتوقعة:**
- **التصدير:** ملف Excel مع 3 موردين + عناوين عربية
- **الاستيراد:** رسالة نجاح + ظهور الموردين الجدد في القائمة
- **القالب:** ملف Excel مع عناوين + مثال واحد

## في حالة استمرار المشاكل:

### 🔧 **للتصدير:**
- تحقق من وجود موردين في قاعدة البيانات
- تحقق من tenant_id الصحيح
- راجع سجلات Laravel للأخطاء

### 🔧 **للاستيراد:**
- تأكد من تطابق أسماء الأعمدة
- تحقق من صيغة البيانات
- راجع رسائل الخطأ في الواجهة

### 📝 **أوامر مفيدة:**
```bash
# إنشاء موردين تجريبيين إضافيين
php artisan db:seed --class=SuppliersSeeder

# مسح الكاش
php artisan cache:clear
php artisan view:clear

# فحص الموردين في قاعدة البيانات
php artisan tinker
>>> App\Models\Supplier::count()
>>> App\Models\Supplier::where('tenant_id', 1)->get()
```
